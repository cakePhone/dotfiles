exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

# Start notification daemon early so scripts using notify-send won't race
exec-once = mako &

exec-once = ~/dotfiles/scripts/launch_waybar.sh
exec-once = hyprpaper &
exec-once = hypridle &

# Run profile setup after notification daemon is available
exec-once = ~/dotfiles/scripts/profiles.sh true
exec-once = ~/dotfiles/scripts/disable_microphone.sh

# Start background services via systemd user where possible; fallback to background launch
exec-once = swayosd-server &

# Start network and auth services via systemd user where possible (non-fatal)
exec-once = bash -c 'systemctl --user start --no-block NetworkManager.service || true'
exec-once = systemctl --user start hyprpolkit.service

# Start background helpers (fallback to direct launch)
exec-once = kdeconnectd &
exec-once = kdeconnect-indicator --no-autostart &
exec-once = nm-applet --indicator &

# Auth and portals
exec-once = systemctl --user start hyprpolkit.service
exec-once = gnome-keyring-daemon --start --components=secrets,ssh || true
exec-once = dbus-update-activation-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP SSH_AUTH_SOCK
exec-once = /usr/lib/xdg-desktop-portal-hyprland &

# Start apps in their own workspaces via uwsm so the session manager controls placement and lifecycle
exec-once = [workspace 1 silent] uwsm-app -- kitty
exec-once = [workspace 2 silent] uwsm-app -- zen-browser
exec-once = [workspace 3 silent] uwsm-app -- vesktop
exec-once = [workspace 4 silent] uwsm-app -- youtube-music

exec-once = systemctl --user start elephant.service
